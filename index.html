<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Synthesis - A/V Experience</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Hydra Synth -->
    <script src="https://unpkg.com/hydra-synth@1.3.0/dist/hydra-synth.js"></script>
    
    <!-- Fonts: Inter + Expanded Glitch Fonts List -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=Pixelify+Sans&family=Courier+Prime:wght@700&family=Bangers&family=Orbitron:wght@900&family=Playfair+Display:ital,wght@1,900&family=Monoton&family=Press+Start+2P&family=Permanent+Marker&family=Righteous&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: black;
            color: white;
            overflow: hidden; /* Prevent body scroll */
            touch-action: none;
            height: 100dvh; 
            width: 100vw;
        }
        
        /* Custom Animations */
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        @keyframes scroll-right {
            0% { transform: translateX(-50%); }
            100% { transform: translateX(0); }
        }

        .animate-scroll-left {
            animation: scroll-left linear infinite;
        }
        .animate-scroll-right {
            animation: scroll-right linear infinite;
        }

        /* Hide scrollbars */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Utility for transitions */
        .view-transition {
            transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-out-scale {
            opacity: 0;
            transform: scale(1.1);
            filter: blur(4px);
            pointer-events: none;
        }
        
        .fade-in-up {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .hidden-down {
            opacity: 0;
            transform: translateY(2rem);
            pointer-events: none;
        }
    </style>
</head>
<body class="selection:bg-white selection:text-black">

    <!-- APP CONTAINER -->
    <div id="app" class="relative w-full h-full">

        <!-- === HOME VIEW === -->
        <div id="home-view" class="absolute inset-0 view-transition opacity-100 scale-100 blur-0">
            
            <!-- Navbar -->
            <nav class="absolute top-0 w-full p-4 md:p-8 flex justify-between items-center z-50 pointer-events-none">
                <!-- PULSANTE EXIT (Sinistra) -->
                <button onclick="handleExit()" class="pointer-events-auto text-xs font-black tracking-[0.2em] text-red-600 hover:text-red-400 transition-colors uppercase font-mono">
                    [ EXIT ]
                </button>

                <!-- PULSANTE HELP (Destra) -->
                <button onclick="toggleHelp()" class="pointer-events-auto flex items-center justify-center w-6 h-6 rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition-all font-bold text-xs shadow-[0_0_5px_rgba(255,255,255,0.3)]">
                    ?
                </button>
            </nav>

            <!-- Hero Text -->
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20 text-center w-full px-4 pointer-events-none">
                <h1 id="synthesis-title" class="text-4xl sm:text-6xl md:text-8xl lg:text-9xl font-bold tracking-tighter mb-2 text-white uppercase whitespace-nowrap transition-all duration-75">
                    Synthesis
                </h1>
                
                <p class="mb-6 text-[10px] md:text-xs font-sans tracking-wide uppercase opacity-70 text-gray-300">
                    Si consiglia l'uso delle cuffie
                </p>

                <p class="mt-4 md:mt-8 text-[10px] md:text-xs font-sans tracking-[0.3em] uppercase opacity-60 animate-pulse text-gray-400">
                    Clicca per esplorare
                </p>
            </div>

            <!-- Lanes Container -->
            <div id="lanes-container" class="absolute inset-0 w-full h-full z-10"></div>
        </div>

        <!-- === HELP MODAL (Pop-up Guida) - Dark Style === -->
        <div id="help-modal" class="absolute inset-0 z-[60] bg-black/95 backdrop-blur-md flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
            <div class="bg-black text-white p-6 md:p-8 max-w-md w-full mx-4 relative shadow-[0_0_30px_rgba(255,255,255,0.1)] transform transition-transform scale-100 border-2 border-white">
                <button onclick="toggleHelp()" class="absolute top-2 right-4 text-white hover:text-gray-400 font-bold text-2xl">&times;</button>
                
                <h2 class="text-xl md:text-2xl font-bold mb-6 uppercase tracking-wider border-b border-white/30 pb-2">Guida</h2>
                
                <ul class="space-y-4 font-sans text-xs md:text-sm leading-relaxed text-gray-200">
                    <li class="flex items-start">
                        <span class="mr-3 font-bold text-white">1.</span> 
                        <span>Clicca sulle immagini per avviare i vari effetti visivi.</span>
                    </li>
                    <li class="flex items-start">
                        <span class="mr-3 font-bold text-white">2.</span> 
                        <span>Le icone in alto a destra di ogni immagine indicano la funzionalitÃ  specifica (es. interazione mouse, microfono, webcam).</span>
                    </li>
                    <li class="flex items-start">
                        <span class="mr-3 font-bold text-white">3.</span> 
                        <span><span class="font-bold text-white">Attenzione:</span> Si consiglia vivamente l'uso delle cuffie ðŸŽ§</span>
                    </li>
                    <li class="flex items-start">
                        <span class="mr-3 font-bold text-white">4.</span> 
                        <span>Utilizza browser che permettano l'accesso a microfono e webcam (Chrome, Safari, ecc.).</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- === EXIT VIEW (Schermata Segreta) === -->
        <div id="exit-view" class="absolute inset-0 z-[100] bg-black flex flex-col items-center justify-center hidden">
            <h1 class="text-2xl md:text-5xl font-mono font-bold tracking-widest text-red-600 uppercase animate-pulse text-center px-4 leading-relaxed glitch-text">
                YOU CAN'T ESCAPE<br>FROM YOURSELF
            </h1>
        </div>

        <!-- === DETAIL VIEW === -->
        <div id="detail-view" class="absolute inset-0 z-50 bg-white flex flex-col view-transition hidden-down">
            
            <!-- Header (Back Button) -->
            <div class="absolute top-0 left-0 w-full p-4 md:p-8 z-50 pointer-events-none">
                <button onclick="goBack()" id="back-btn" class="pointer-events-auto group flex items-center space-x-2 text-xs md:text-sm font-sans uppercase tracking-widest transition-colors text-black hover:text-gray-500 cursor-pointer bg-black/20 backdrop-blur-sm p-3 md:p-2 rounded-full text-white hover:bg-black/40">
                    <!-- Arrow Left Icon -->
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transform group-hover:-translate-x-1 transition-transform">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    <span>Torna alla Gallery</span>
                </button>
            </div>

            <!-- Content Container -->
            <div class="flex-1 w-full h-full relative bg-black flex items-center justify-center overflow-hidden">
                
                <!-- CANVAS for Experience A/V -->
                <canvas id="hydra-canvas" class="absolute inset-0 w-full h-full object-cover hidden"></canvas>

                <!-- IFRAME for External Links -->
                <iframe id="external-iframe" class="absolute inset-0 w-full h-full border-0 hidden bg-white"></iframe>

                <!-- STANDARD CONTENT -->
                <div id="standard-content" class="text-center space-y-6 max-w-2xl px-4 md:px-8 bg-white/90 p-8 md:p-12 rounded-xl hidden">
                    <div class="inline-block p-4 rounded-full bg-black text-white mb-4">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="5 9 2 12 5 15"></polyline><polyline points="9 5 12 2 15 5"></polyline><polyline points="15 19 12 22 9 19"></polyline><polyline points="19 9 22 12 19 15"></polyline><line x1="2" y1="12" x2="22" y2="12"></line><line x1="12" y1="2" x2="12" y2="22"></line></svg>
                    </div>
                    <p class="text-gray-500 font-sans leading-relaxed">Contenuto Standard.</p>
                </div>

                <!-- SPECIAL AV OVERLAY -->
                <div id="av-overlay" class="absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/40 backdrop-blur-sm hidden">
                    <button id="start-btn" class="flex items-center gap-3 px-8 py-4 bg-white text-black font-bold uppercase tracking-widest hover:bg-gray-200 transition-transform transform hover:scale-105 rounded-full cursor-pointer">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="black" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <span id="start-btn-text">AVVIA ESPERIENZA</span>
                    </button>
                    <!-- Nuovo Elemento per il Sottotitolo -->
                    <p id="start-btn-subtext" class="mt-6 text-white text-[10px] md:text-xs font-sans tracking-widest uppercase opacity-80 text-center max-w-md px-4"></p>
                    
                    <!-- SLOGAN SPECIALE PER A/V DISTORTION -->
                    <h2 id="av-slogan" class="hidden absolute bottom-16 md:bottom-20 text-white text-2xl md:text-4xl tracking-[0.2em] text-center w-full px-4 drop-shadow-lg" style="font-family: 'Bebas Neue', sans-serif;">
                        AMPLIFY YOUR POSITIVE AND NEGATIVE SENSATIONS
                    </h2>
                </div>

            </div>
        </div>

    </div>

    <!-- MAIN SCRIPT -->
    <script>
        // --- DATA ---
        const lanesData = [
            {
                id: 'lane-1', 
                mobileTop: 'top-[5%]', desktopTop: 'md:top-[5%]', 
                direction: 'left', speed: 40,
                items: [
                    { 
                        id: 1, 
                        title: "Synthesis 6", 
                        image: "https://github.com/NgaLegins/Synthesis6/blob/main/Screenshot%202026-01-20%20alle%2022.39.03.png?raw=true",
                        link: "https://ngalegins.github.io/Synthesis6/" 
                    },
                    { 
                        id: 5, 
                        title: "Synthesis 7", 
                        // NUOVA Copertina aggiornata
                        image: "https://github.com/NgaLegins/Synthesis7/blob/main/Screenshot%202026-01-21%20alle%2011.33.02.png?raw=true",
                        link: "https://ngalegins.github.io/Synthesis7/",
                        hasSwipe: true, 
                        iconColor: 'text-white' 
                    }
                ]
            },
            {
                id: 'lane-2', 
                mobileTop: 'top-[22%]', desktopTop: 'md:top-[25%]', 
                direction: 'right', speed: 55,
                items: [
                     { 
                         id: 2, 
                         title: "Synthesis 2", 
                         image: "https://github.com/NgaLegins/Synthesis2/blob/main/Screenshot%202026-01-21%20alle%2000.42.54.png?raw=true",
                         link: "https://ngalegins.github.io/Synthesis2/",
                         hasAudio: true 
                     },
                     {
                         id: 8,
                         title: "Synthesis 8",
                         image: "https://github.com/NgaLegins/Synthesis8/blob/main/Screenshot%202026-01-21%20alle%2011.09.15.png?raw=true",
                         link: "https://ngalegins.github.io/Synthesis8/",
                         hasAudio: true, 
                         iconColor: 'text-white'
                     }
                ]
            },
            {
                id: 'lane-3', 
                mobileTop: 'top-[62%]', desktopTop: 'md:top-[65%]', 
                direction: 'right', speed: 45,
                items: [
                    { 
                        id: 'special-av', 
                        title: "A/V Distortion", 
                        image: "https://raw.githubusercontent.com/NgaLegins/Synthesis/main/Screenshot%202026-01-20%20alle%2015.40.25.png",
                        link: "https://ngalegins.github.io/Synthesis5/",
                        isSpecial: true,
                    },
                    { 
                        id: 6, 
                        title: "Synthesis 3", 
                        image: "https://github.com/NgaLegins/Synthesis3/blob/main/Screenshot%202026-01-20%20alle%2023.26.23.png?raw=true",
                        link: "https://ngalegins.github.io/Synthesis3/",
                        hasWebcam: true, 
                        iconColor: 'text-black' 
                    }
                ]
            },
            {
                id: 'lane-4', 
                mobileTop: 'top-[80%]', desktopTop: 'md:top-[82%]',
                direction: 'left', speed: 35,
                items: [
                    { 
                        id: 4, 
                        title: "Synthesis 4", 
                        image: "https://github.com/NgaLegins/Synthesis4/blob/main/Screenshot%202026-01-20%20alle%2017.16.08.png?raw=true", 
                        link: "https://ngalegins.github.io/Synthesis4/", 
                        hasMic: true, 
                        iconColor: 'text-black' 
                    }
                ]
            }
        ];

        // --- STATE & REFS ---
        let currentItem = null;
        let isPlaying = false;
        let animationId = null;
        let toneTransport = null;
        let hydraInstance = null;
        let scriptsLoaded = false;

        // --- INITIALIZATION ---
        window.onload = () => {
            renderLanes();
            startTitleGlitch(); 
        };

        // --- HELP MODAL LOGIC ---
        function toggleHelp() {
            const modal = document.getElementById('help-modal');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
            } else {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        // --- EXIT LOGIC (SOUND & VISUAL) ---
        function handleExit() {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            if (AudioContext) {
                const ctx = new AudioContext();
                const bufferSize = ctx.sampleRate * 3; 
                const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
                const data = buffer.getChannelData(0);

                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }

                const noise = ctx.createBufferSource();
                noise.buffer = buffer;
                
                const gain = ctx.createGain();
                gain.gain.value = 0.5;

                noise.connect(gain);
                gain.connect(ctx.destination);
                noise.start();
            }

            const homeView = document.getElementById('home-view');
            homeView.classList.remove('opacity-100');
            homeView.classList.add('opacity-0');
            
            setTimeout(() => {
                const exitView = document.getElementById('exit-view');
                exitView.classList.remove('hidden');
                
                setTimeout(() => {
                    exitView.classList.add('hidden');
                    homeView.classList.remove('opacity-0');
                    homeView.classList.add('opacity-100');
                }, 3000);
            }, 300);
        }

        // --- TITLE GLITCH ANIMATION ---
        function startTitleGlitch() {
            const titleEl = document.getElementById('synthesis-title');
            const fonts = [
                '"Pixelify Sans", sans-serif', 
                '"Courier Prime", monospace', 
                '"Playfair Display", serif', 
                '"Bangers", cursive', 
                '"Orbitron", sans-serif',
                '"Monoton", cursive',
                '"Press Start 2P", cursive',
                '"Permanent Marker", cursive',
                '"Righteous", cursive'
            ];
            const defaultFont = '"Inter", sans-serif';

            setInterval(() => {
                let glitchCount = 0;
                const glitchInterval = setInterval(() => {
                    const randomFont = fonts[Math.floor(Math.random() * fonts.length)];
                    titleEl.style.fontFamily = randomFont;
                    
                    glitchCount++;
                    if (glitchCount >= 8) { 
                        clearInterval(glitchInterval);
                        titleEl.style.fontFamily = defaultFont;
                        titleEl.style.transform = 'scale(1)';
                    }
                }, 250); 

            }, 5000); 
        }

        // --- RENDER LANES ---
        function renderLanes() {
            const container = document.getElementById('lanes-container');
            let html = '';

            lanesData.forEach(lane => {
                let itemsHtml = '';
                const loopItems = [...lane.items, ...lane.items, ...lane.items, ...lane.items];
                
                loopItems.forEach((item, idx) => {
                    const uniqueId = `item-${lane.id}-${idx}`;
                    const itemData = encodeURIComponent(JSON.stringify(item));
                    
                    const borderClass = ''; 
                    
                    // Logic per le icone con gestione colore
                    let iconHtml = '';
                    const iconColor = item.iconColor || 'text-white';
                    const iconShadow = iconColor === 'text-black' ? '' : 'drop-shadow-md';

                    if (item.isSpecial) {
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                           </div>`;
                    } else if (item.hasMic) {
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                           </div>`;
                    } else if (item.hasWebcam) {
                        // Icona Webcam
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="10" r="8"></circle><circle cx="12" cy="10" r="3"></circle><path d="M7 22h10"></path><path d="M12 22v-4"></path></svg>
                           </div>`;
                    } else if (item.hasMouse) {
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path><path d="M13 13l6 6"></path></svg>
                           </div>`;
                    } else if (item.hasAudio) {
                        // Icona Audio (Speaker)
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                           </div>`;
                    } else if (item.hasSwipe) {
                        // Icona Dito (Mano indicativa/Swipe)
                        iconHtml = `<div class="absolute top-2 right-2 ${iconColor} ${iconShadow} animate-pulse">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path><path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path><path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"></path><path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"></path></svg>
                           </div>`;
                    }
                    
                    const sparkleHtml = item.isSpecial
                        ? `<svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>`
                        : '';

                    itemsHtml += `
                        <div 
                            onclick="handleItemClick('${itemData}')"
                            class="relative group cursor-pointer transition-transform duration-300 hover:scale-105 hover:z-30 shrink-0"
                        >
                            <!-- Immagini responsive senza bordi bianchi -->
                            <div class="relative w-28 sm:w-40 md:w-64 aspect-[4/3] overflow-hidden shadow-2xl ${borderClass}">
                                <div class="w-full h-full overflow-hidden relative">
                                    <img 
                                        src="${item.image}" 
                                        alt="${item.title}" 
                                        class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500"
                                        onerror="this.src='https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'"
                                    />
                                    <div class="absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors duration-300"></div>
                                    ${iconHtml}
                                </div>
                            </div>
                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                                <span class="text-[10px] md:text-xs font-sans tracking-widest bg-black text-white px-2 py-1 uppercase border border-white/20 flex items-center">
                                    ${item.title} ${sparkleHtml}
                                </span>
                            </div>
                        </div>
                    `;
                });

                const animClass = lane.direction === 'left' ? 'animate-scroll-left' : 'animate-scroll-right';
                
                // Classi responsive per posizionamento verticale
                const posClasses = `${lane.mobileTop} ${lane.desktopTop}`;

                html += `
                    <div class="absolute w-full flex items-center overflow-hidden h-32 md:h-48 ${posClasses}">
                        <div class="flex items-center space-x-12 md:space-x-48 w-max ${animClass}" style="animation-duration: ${lane.speed}s; padding-left: 10vw;">
                            ${itemsHtml}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // --- NAVIGATION LOGIC ---
        function handleItemClick(encodedItem) {
            const item = JSON.parse(decodeURIComponent(encodedItem));
            currentItem = item;

            document.getElementById('home-view').classList.add('fade-out-scale');
            document.getElementById('home-view').classList.remove('opacity-100', 'scale-100', 'blur-0');
            
            setTimeout(() => {
                const detailView = document.getElementById('detail-view');
                detailView.classList.remove('hidden-down');
                detailView.classList.add('fade-in-up');
                
                setupDetailView(item);
            }, 600);
        }

        function goBack() {
            window.location.reload();
        }

        function setupDetailView(item) {
            const backBtn = document.getElementById('back-btn');
            const iframe = document.getElementById('external-iframe');
            const overlay = document.getElementById('av-overlay');
            const startBtn = document.getElementById('start-btn');
            const startText = document.getElementById('start-btn-text');
            const startSubtext = document.getElementById('start-btn-subtext');
            const avSlogan = document.getElementById('av-slogan');
            
            document.getElementById('hydra-canvas').classList.add('hidden');
            overlay.classList.add('hidden');
            document.getElementById('standard-content').classList.add('hidden');
            iframe.classList.add('hidden');
            iframe.src = "";
            startSubtext.innerText = ""; 
            avSlogan.classList.add('hidden'); // Nascondi slogan di default

            // SPECIFIC LOGIC FOR A/V DISTORTION (Click to Start Overlay)
            if (item.id === 'special-av') {
                overlay.classList.remove('hidden');
                startText.innerText = "Dopo aver cliccato, riclicca";
                
                // Show Slogan ONLY for A/V Distortion
                avSlogan.classList.remove('hidden');
                
                startBtn.onclick = function() {
                    overlay.classList.add('hidden');
                    iframe.src = item.link;
                    iframe.classList.remove('hidden');
                };

                backBtn.classList.add('bg-black/50', 'text-white');
                return;
            }

            if (item.link) {
                iframe.src = item.link;
                iframe.classList.remove('hidden');
                backBtn.classList.add('bg-black/50', 'text-white');
            } else if (item.isSpecial) {
                // Logic for other internal special items if any (currently special-av has link)
                document.getElementById('hydra-canvas').classList.remove('hidden');
                overlay.classList.remove('hidden');
                startText.innerText = "AVVIA ESPERIENZA";
                
                startBtn.onclick = startExperience;
                
                backBtn.classList.remove('bg-black/50');
                backBtn.classList.add('text-white');

                if (!scriptsLoaded) {
                    startBtn.disabled = true;
                    startText.innerText = "CARICAMENTO...";
                    try {
                        loadScript("https://unpkg.com/tone@14.7.77/build/Tone.js")
                        .then(() => {
                            scriptsLoaded = true;
                            startBtn.disabled = false;
                            startText.innerText = "AVVIA ESPERIENZA";
                        });
                    } catch(e) { console.error(e); }
                }
            } else {
                document.getElementById('standard-content').classList.remove('hidden');
                backBtn.classList.remove('bg-black/50', 'text-white');
                backBtn.classList.add('text-black');
            }
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                if (document.querySelector(`script[src="${src}"]`)) {
                    resolve();
                    return;
                }
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.body.appendChild(script);
            });
        }

        async function startExperience() {
            // (Funzione per esperienze locali, non usata se c'Ã¨ un link esterno)
            try {
                document.getElementById('av-overlay').classList.add('hidden');
                await window.Tone.start();
                isPlaying = true;
                // Hydra logic if needed locally...
            } catch (e) {
                console.error("Error starting AV:", e);
            }
        }

        function stopExperience() {
            isPlaying = false;
            // Cleanup logic...
        }

    </script>
</body>
</html>
